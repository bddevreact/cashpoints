# ЁЯЪА ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржорж┐ржирж┐ ржЕрзНржпрж╛ржк ржЧрж╛ржЗржб - BT Community

## ЁЯУ▒ **ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржорж┐ржирж┐ ржЕрзНржпрж╛ржк ржХрзАржнрж╛ржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ**

### **ржорзВрж▓ ржзрж╛рж░ржгрж╛**
ржПржЗ ржЕрзНржпрж╛ржкржЯрж┐ ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржорж┐ржирж┐ ржЕрзНржпрж╛ржк рж╣рж┐рж╕рзЗржмрзЗ ржХрж╛ржЬ ржХрж░рзЗ, ржпрзЗржЦрж╛ржирзЗ:
- ржЗржЙржЬрж╛рж░ ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржерзЗржХрзЗ ржЕрзНржпрж╛ржк ржЦрзЛрж▓рзЗ
- ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржЗржЙржЬрж╛рж░ ржбрзЗржЯрж╛ ржЕржЯрзЛржорзЗржЯрж┐ржХ рж▓рзЛржб рж╣ржпрж╝
- ржбрзЗржЯрж╛ржмрзЗрж╕рзЗ ржЗржЙржЬрж╛рж░ ржЗржиржлрж░ржорзЗрж╢ржи рж╕рзЗржн рж╣ржпрж╝
- рж░рж┐ржпрж╝рзЗрж▓-ржЯрж╛ржЗржо ржЖржкржбрзЗржЯ ржПржмржВ ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржи

## ЁЯФз **ржЯрзЗржХржирж┐ржХрзНржпрж╛рж▓ рж╕рзЗржЯржЖржк**

### **1. ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо WebApp API ржЗржирзНржЯрж┐ржЧрзНрж░рзЗрж╢ржи**
```typescript
// src/types/telegram.d.ts
declare global {
  interface Window {
    Telegram: {
      WebApp: {
        ready(): void;           // ржЕрзНржпрж╛ржк ржкрзНрж░рж╕рзНрждрзБржд
        expand(): void;          // ржлрзБрж▓ рж╕рзНржХрзНрж░рж┐ржи
        close(): void;           // ржЕрзНржпрж╛ржк ржмржирзНржз
        initDataUnsafe: {
          user?: {
            id: number;          // ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржЗржЙржЬрж╛рж░ ID
            first_name: string;  // ржкрзНрж░ржержо ржирж╛ржо
            last_name?: string;  // рж╢рзЗрж╖ ржирж╛ржо
            username?: string;   // ржЗржЙржЬрж╛рж░ржирзЗржо
            photo_url?: string;  // ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржЫржмрж┐
          };
        };
        MainButton: {
          text: string;
          show(): void;
          hide(): void;
          onClick(callback: () => void): void;
        };
      };
    };
  }
}
```

### **2. ржЕрзНржпрж╛ржк ржЗржирж┐рж╢рж┐ржпрж╝рж╛рж▓рж╛ржЗржЬрзЗрж╢ржи**
```typescript
// src/App.tsx
useEffect(() => {
  if (window.Telegram && window.Telegram.WebApp) {
    try {
      // ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо WebApp ржкрзНрж░рж╕рзНрждрзБржд
      window.Telegram.WebApp.ready();
      window.Telegram.WebApp.expand();
      
      // ржЗржЙржЬрж╛рж░ ржбрзЗржЯрж╛ рж▓рзЛржб
      const user = window.Telegram.WebApp.initDataUnsafe?.user;
      if (user) {
        setUser({
          name: user.first_name,
          photoUrl: user.photo_url || `https://api.dicebear.com/7.x/avataaars/svg?seed=${user.id}`
        });
        loadUserData(user.id.toString());
      }
    } catch (error) {
      console.warn('Telegram WebApp API error:', error);
      handleDemoMode();
    }
  }
}, []);
```

### **3. ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржЗржЙржЬрж╛рж░ ID рж╣рзЗржбрж╛рж░**
```typescript
// src/lib/supabase.ts
export const supabase = createClient<Database>(supabaseUrl, supabaseAnonKey, {
  global: {
    headers: {
      'X-Telegram-User-Id': window.Telegram?.WebApp?.initDataUnsafe?.user?.id?.toString() || ''
    }
  }
});
```

## ЁЯЧДя╕П **ржбрзЗржЯрж╛ржмрзЗрж╕ ржЗржирзНржЯрж┐ржЧрзНрж░рзЗрж╢ржи**

### **ржЗржЙржЬрж╛рж░ ржЯрзЗржмрж┐рж▓ рж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░**
```sql
CREATE TABLE users (
  id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
  telegram_id text UNIQUE NOT NULL,        -- ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржЗржЙржЬрж╛рж░ ID
  username text,
  first_name text,
  last_name text,
  photo_url text,
  balance numeric DEFAULT 0,
  energy integer DEFAULT 100,
  level integer DEFAULT 1,
  experience_points integer DEFAULT 0,
  referral_code text UNIQUE,
  referred_by text REFERENCES users(telegram_id),
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now()
);
```

### **рж░рзЛрж▓-ржмрзЗрж╕ржб рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐ (RLS)**
```sql
-- ржЗржЙржЬрж╛рж░ рж╢рзБржзрзБ ржирж┐ржЬрзЗрж░ ржбрзЗржЯрж╛ ржжрзЗржЦрждрзЗ ржкрж╛рж░ржмрзЗ
CREATE POLICY "Users can view own data" ON users
  FOR SELECT USING (telegram_id = get_telegram_user_id());

CREATE POLICY "Users can update own data" ON users
  FOR UPDATE USING (telegram_id = get_telegram_user_id());
```

## ЁЯУК **ржорзВрж▓ ржлрж┐ржЪрж╛рж░ржЧрзБрж▓рзЛ**

### **1. рж╣рзЛржо ржкрзЗржЬ**
- ржЗржЙржЬрж╛рж░ ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржПржмржВ рж╕рзНржЯрзНржпрж╛ржЯрж╕
- рж░рж┐ржпрж╝рзЗрж▓-ржЯрж╛ржЗржо ржЖржкржбрзЗржЯ
- ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржЗржиржлрж░ржорзЗрж╢ржи

### **2. ржЯрж╛рж╕рзНржХ рж╕рж┐рж╕рзНржЯрзЗржо**
- ржбрзЗржЗрж▓рж┐ ржЪрзЗржХ-ржЗржи
- рж░рзЗржлрж╛рж░рзЗрж▓ ржЯрж╛рж╕рзНржХ
- ржПржХрзНрж╕ржкрзЗрж░рж┐ржпрж╝рзЗржирзНрж╕ ржкржпрж╝рзЗржирзНржЯ

### **3. рж░рзЗржлрж╛рж░рзЗрж▓ рж╕рж┐рж╕рзНржЯрзЗржо**
- ржорж╛рж▓рзНржЯрж┐-рж▓рзЗржнрзЗрж▓ рж░рзЗржлрж╛рж░рзЗрж▓
- рж░рзЗржлрж╛рж░рзЗрж▓ ржХрзЛржб ржЬрзЗржирж╛рж░рзЗрж╢ржи
- ржХржорж┐рж╢ржи ржХрзНржпрж╛рж▓ржХрзБрж▓рзЗрж╢ржи

### **4. ржУржпрж╝рж╛рж▓рзЗржЯ рж╕рж┐рж╕рзНржЯрзЗржо**
- ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЯрзНрж░рзНржпрж╛ржХрж┐ржВ
- ржЙржЗржержбрзНрж░рж▓ рж░рж┐ржХрзЛржпрж╝рзЗрж╕рзНржЯ
- ржЯрзНрж░рж╛ржиржЬрзЗржХрж╢ржи рж╣рж┐рж╕рзНржЯрж░рж┐

## ЁЯЪА **ржбрзЗржкрзНрж▓ржпрж╝ржорзЗржирзНржЯ рж╕рзНржЯрзЗржкрж╕**

### **1. ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржмржЯ рж╕рзЗржЯржЖржк**
```bash
# @BotFather ржП ржирждрзБржи ржмржЯ рждрзИрж░рж┐ ржХрж░рзБржи
# /newbot ржХржорж╛ржирзНржб ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи
# ржмржЯ ржирж╛ржо ржПржмржВ ржЗржЙржЬрж╛рж░ржирзЗржо ржжрж┐ржи
# API ржЯрзЛржХрзЗржи ржХржкрж┐ ржХрж░рзБржи
```

### **2. ржорж┐ржирж┐ ржЕрзНржпрж╛ржк ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи**
```bash
# @BotFather ржП /setmenubutton ржХржорж╛ржирзНржб
# ржмржЯ рж╕рж┐рж▓рзЗржХрзНржЯ ржХрж░рзБржи
# ржорзЗржирзБ ржЯрзЗржХрзНрж╕ржЯ ржжрж┐ржи: "BT Community"
# URL ржжрж┐ржи: ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржкрзЗрж░ URL
```

### **3. ржУржпрж╝рзЗржм ржЕрзНржпрж╛ржк рж╕рзЗржЯржЖржк**
```bash
# @BotFather ржП /newapp ржХржорж╛ржирзНржб
# ржмржЯ рж╕рж┐рж▓рзЗржХрзНржЯ ржХрж░рзБржи
# ржЕрзНржпрж╛ржк ржирж╛ржо ржжрж┐ржи: "BT Community"
# рж╢рж░рзНржЯ ржбрж┐рж╕ржХрзНрж░рж┐ржкрж╢ржи ржжрж┐ржи
# ржлржЯрзЛ ржЖржкрж▓рзЛржб ржХрж░рзБржи
```

### **4. ржбрзЛржорзЗржЗржи ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи**
```typescript
// vite.config.ts
export default defineConfig({
  server: {
    headers: {
      'Cross-Origin-Opener-Policy': 'unsafe-none'
    }
  }
});
```

## ЁЯФР **рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐ ржлрж┐ржЪрж╛рж░**

### **1. ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи**
- `initData` рж╣рзНржпрж╛рж╢ ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи
- ржЗржЙржЬрж╛рж░ ID ржнрзНржпрж╛рж▓рж┐ржбрзЗрж╢ржи
- рж╕рзЗрж╢ржи ржорзНржпрж╛ржирзЗржЬржорзЗржирзНржЯ

### **2. ржбрзЗржЯрж╛ржмрзЗрж╕ рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐**
- Row Level Security (RLS)
- ржЗржЙржЬрж╛рж░-ржмрзЗрж╕ржб ржбрзЗржЯрж╛ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕
- SQL ржЗржиржЬрзЗржХрж╢ржи ржкрзНрж░рж┐ржнрзЗржирж╢ржи

### **3. API рж╕рж┐ржХрж┐ржЙрж░рж┐ржЯрж┐**
- ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржЗржЙржЬрж╛рж░ ID рж╣рзЗржбрж╛рж░
- рж░рзЗржЯ рж▓рж┐ржорж┐ржЯрж┐ржВ
- CORS ржХржиржлрж┐ржЧрж╛рж░рзЗрж╢ржи

## ЁЯУ▒ **ржЗржЙржЬрж╛рж░ ржПржХрзНрж╕ржкрзЗрж░рж┐ржпрж╝рзЗржирзНрж╕**

### **1. рж╕рзНржорзБрже ржЗржирзНржЯрж┐ржЧрзНрж░рзЗрж╢ржи**
- ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржерзЗржХрзЗ рж╕рж┐ржорзНржкрж▓ рж▓ржЧржЗржи
- ржкрзНрж░рзЛржлрж╛ржЗрж▓ ржЕржЯрзЛ-рж▓рзЛржб
- рж╕рзЗрж╢ржи ржкрж╛рж░рж╕рж┐рж╕рзНржЯрзЗржирзНрж╕

### **2. рж░рж┐ржпрж╝рзЗрж▓-ржЯрж╛ржЗржо ржлрж┐ржЪрж╛рж░**
- рж▓рж╛ржЗржн ржмрзНржпрж╛рж▓рзЗржирзНрж╕ ржЖржкржбрзЗржЯ
- ржЗржирж╕рзНржЯрзНржпрж╛ржирзНржЯ ржирзЛржЯрж┐ржлрж┐ржХрзЗрж╢ржи
- ржЕрзНржпрж╛ржХрзНржЯрж┐ржнрж┐ржЯрж┐ ржлрж┐ржб

### **3. ржорзЛржмрж╛ржЗрж▓ ржЕржкржЯрж┐ржорж╛ржЗржЬрзЗрж╢ржи**
- рж░рзЗрж╕ржкржирж╕рж┐ржн ржбрж┐ржЬрж╛ржЗржи
- ржЯрж╛ржЪ-ржлрзНрж░рзЗржирзНржбрж▓рж┐ UI
- ржлрж╛рж╕рзНржЯ рж▓рзЛржбрж┐ржВ

## ЁЯЫая╕П **ржбрзЗржнрзЗрж▓ржкржорзЗржирзНржЯ ржЯрж┐ржкрж╕**

### **1. ржЯрзЗрж╕рзНржЯрж┐ржВ**
```typescript
// ржбрзЗржорзЛ ржорзЛржб ржлрж░ ржбрзЗржнрзЗрж▓ржкржорзЗржирзНржЯ
const handleDemoMode = () => {
  setIsDemoMode(true);
  setUser({
    name: 'Demo User',
    photoUrl: 'https://api.dicebear.com/7.x/avataaars/svg?seed=demo'
  });
  loadUserData('demo_user_123');
};
```

### **2. ржПрж░рж░ рж╣рзНржпрж╛ржирзНржбрж▓рж┐ржВ**
```typescript
try {
  // ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо API ржХрж▓
} catch (error) {
  console.warn('Telegram WebApp API error:', error);
  // ржлрзНржпрж╛рж▓ржмрзНржпрж╛ржХ ржорзЛржб
  handleDemoMode();
}
```

### **3. ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕ ржЕржкржЯрж┐ржорж╛ржЗржЬрзЗрж╢ржи**
- рж▓рзЗржЬрж┐ рж▓рзЛржбрж┐ржВ
- ржЗржорзЗржЬ ржЕржкржЯрж┐ржорж╛ржЗржЬрзЗрж╢ржи
- ржХрзНржпрж╛рж╢рж┐ржВ рж╕рзНржЯрзНрж░рзНржпрж╛ржЯрзЗржЬрж┐

## ЁЯУИ **ржоржирж┐ржЯрж░рж┐ржВ ржПржмржВ ржЕрзНржпрж╛ржирж╛рж▓рж┐ржЯрж┐ржХрзНрж╕**

### **1. ржЗржЙржЬрж╛рж░ ржЕрзНржпрж╛ржХрзНржЯрж┐ржнрж┐ржЯрж┐**
- рж▓ржЧржЗржи ржЯрж╛ржЗржо
- ржлрж┐ржЪрж╛рж░ ржмрзНржпржмрж╣рж╛рж░
- рж╕рзЗрж╢ржи ржбрзБрж░рзЗрж╢ржи

### **2. ржкрж╛рж░ржлрж░ржорзНржпрж╛ржирзНрж╕ ржорзЗржЯрзНрж░рж┐ржХрзНрж╕**
- рж▓рзЛржбрж┐ржВ ржЯрж╛ржЗржо
- API рж░рзЗрж╕ржкржирзНрж╕ ржЯрж╛ржЗржо
- ржПрж░рж░ рж░рзЗржЯ

### **3. ржмрж┐ржЬржирзЗрж╕ ржорзЗржЯрзНрж░рж┐ржХрзНрж╕**
- ржЗржЙржЬрж╛рж░ рж░рж┐ржЯрзЗржирж╢ржи
- рж░рзЗржлрж╛рж░рзЗрж▓ ржХржиржнрж╛рж░рзНрж╢ржи
- рж░рзЗржнрж┐ржирж┐ржЙ ржЯрзНрж░рзНржпрж╛ржХрж┐ржВ

## ЁЯФо **ржнржмрж┐рж╖рзНржпржд ржЖржкржбрзЗржЯ**

### **1. ржирждрзБржи ржлрж┐ржЪрж╛рж░**
- ржЧрзНрж░рзБржк ржЪрзНржпрж╛рж▓рзЗржЮрзНржЬ
- рж▓рж┐ржбрж╛рж░ржмрзЛрж░рзНржб
- ржЕрзНржпрж╛ржЪрж┐ржнржорзЗржирзНржЯ рж╕рж┐рж╕рзНржЯрзЗржо

### **2. ржЗржирзНржЯрж┐ржЧрзНрж░рзЗрж╢ржи**
- ржХрзНрж░рж┐ржкрзНржЯрзЛ ржУржпрж╝рж╛рж▓рзЗржЯ
- рж╕рзЛрж╢рзНржпрж╛рж▓ ржлрж┐ржЪрж╛рж░
- ржкрзЗржорзЗржирзНржЯ ржЧрзЗржЯржУржпрж╝рзЗ

### **3. рж╕рзНржХрзЗрж▓рзЗржмрж┐рж▓рж┐ржЯрж┐**
- ржорж╛ржЗржХрзНрж░рзЛрж╕рж╛рж░рзНржнрж┐рж╕ ржЖрж░рзНржХрж┐ржЯрзЗржХржЪрж╛рж░
- рж▓рзЛржб ржмрзНржпрж╛рж▓рзЗржирзНрж╕рж┐ржВ
- CDN ржЕржкржЯрж┐ржорж╛ржЗржЬрзЗрж╢ржи

---

## ЁЯУЮ **рж╕рж╛ржкрзЛрж░рзНржЯ**

ржпржжрж┐ ржХрзЛржи рж╕ржорж╕рзНржпрж╛ рж╣ржпрж╝ ржмрж╛ рж╕рж╛рж╣рж╛ржпрзНржп рж▓рж╛ржЧрзЗ:
- ржЯрзЗржХржирж┐ржХрзНржпрж╛рж▓ ржЗрж╕рзНржпрзБ: GitHub Issues
- ржЬрзЗржирж╛рж░рзЗрж▓ ржкрзНрж░рж╢рзНржи: ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржЧрзНрж░рзБржк
- ржПржорж╛рж░ржЬрзЗржирзНрж╕рж┐: ржЕрзНржпрж╛ржбржорж┐ржи ржХржирзНржЯрж╛ржХрзНржЯ

**ржЯрзЗрж▓рж┐ржЧрзНрж░рж╛ржо ржорж┐ржирж┐ ржЕрзНржпрж╛ржк рж╕рж╛ржХрж╕рзЗрж╕ржлрзБрж▓рж┐ ржбрзЗржкрзНрж▓ржпрж╝ ржХрж░рзБржи! ЁЯОЙ** 